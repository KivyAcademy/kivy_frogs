#:kivy 1.8.0

<BackgroundPH>
    source: self.source
    size: app.window.size
    allow_stretch: True
    keep_ratio: False


<ToolBar>
    offset: dp(10)
    canvas:
        Color:
            rgba: .7, .7, .7, .5
        Rectangle:
            pos: root.pos
            size: root.size
    Widget:
        # the place holders(PH) must be in widgets,
        # else the new PH don't lay over the PH before
        pos: 0, 0
        WaterLilyPH:
            pos: 0, 0
    Widget:
        pos: (dp(60) + root.offset, 0)
        StoneLilyPH:
            pos: (dp(60) + root.offset, 0)
    Widget:
        pos: dp(120) + 2 * root.offset, 0
        FrogPH:
            pos: dp(120) + 2 * root.offset, 0


<PHScatter>
    app: app
    size: dp(60), dp(60)
    do_rotation: False
    do_translation: True
    do_scale: False
    auto_bring_to_front: False
    moved: False
    source: self.source
    Image:
        size: root.size
        source: root.source
        allow_stretch: True
        keep_ratio: False


<WaterLilyPH>
    source: "img/water_lily_001.png"


<StoneLilyPH>
    source: "img/water_lily_stone.png"


<BasePH>
    size: dp(200), dp(100)


<FrogPH>
    sit_img: "img/frog_green_sit.png"
    jump_img: "img/frog_green_jump.png"
    source: self.sit_img
    size: dp(35), dp(75)
    place: None
    player: False


<StartPH>
    id: start
    x: dp(300)
    y: 0
    source: "img/start.png"
    frog: frog
    Image:
        id: frog
        size: dp(35), dp(75)
        center_x: root.width / 2
        sit_img: "img/frog_black_blue_sit.png"
        jump_img: "img/frog_black_blue_jump.png"
        source: self.sit_img
        player: True
        place: start


<EndPH>
    id: end
    x: dp(300)
    y: dp(600)
    source: "img/end.png"


<LevelScatter>
    app: app
    do_rotation: False
    do_translation: True
    do_scale: False
    auto_bring_to_front: True


<LevelEditorWidget>
    app: app
    size: app.window.size
    level: level
    delete: delete
    object_count: 0
    BackgroundPH:
        id: background
        source: "img/background_blue.png"
    Widget:
        y: toolbar.top
        height: root.height - toolbar.top
        LevelScatter:
            id: level
            y: 0
            height: -self.y + root.height
            width: -self.x + root.width
            canvas:
                Color:
                    rgb: .9, .9, .9
                Line:
                    width: 1
                    points: self.calculate_line_points()
    ToolBar:
        id: toolbar
        height: dp(65)
        width: root.width
    Widget:
        id: delete
        size: dp(80), dp(80)
        top: root.top
        x: 0
        canvas:
            Color:
                rgba: .9, 0, 0, .7
            Rectangle:
                size: dp(80), dp(80)
                pos: 0, root.height - dp(80)
    Button:
        right: root.right
        top: root.top
        id: close
        text: "Close"
        height: dp(40)
        on_press: app.repeat_level = False; app.close_level_editor()
    Button:
        id: export
        right: root.right
        top: close.y - dp(10)
        text: "Export"
        height: dp(40)
        on_press: root.export_level(root.next_level_name())
    Button:
        id: clear
        right: root.right
        top: export.y - dp(10)
        text: "Clear"
        height: dp(40)
        on_press: app.editor.level.build_standard()
    Button:
        id: test
        right: root.right
        top: clear.y - dp(10)
        text: "Test it"
        height: dp(40)
        on_press: app.repeat_level=True; root.export_level("levels/tmp_level.txt"); app.load_custom_level("levels/tmp_level.txt"); app.close_level_editor()