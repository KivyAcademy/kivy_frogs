#:kivy 1.8.0
#:import randint random.randint
#:import random random.random
# import win kivy.core.window
# import kivy kivy
# import Vector kivy.vector.Vector
# the game background image
<Background>
    source: self.source
    size: app.window.size
    allow_stretch: True
    keep_ratio: False

<Live@Image>
    alive_img: "img/heart.png"
    lost_img: "img/heart_black.png"
    size: dp(30), sp(30)
    source: self.alive_img

# line to draw jump distance
<JumpLine>
    x1: 0
    y1: 0
    x2: 0
    y2: 0
    max: dp(120)
    canvas:
        Color:
            rgba: 1, 0, 0, .9
        Line:
            points: self.x1, self.y1, self.x2, self.y2
            width: dp(1.5)

<Fly>
    scatter: scatter
    source: "img/fly.png"
    size: dp(30), dp(30)
    speed: 1.5
    rot_change: random()
    
    Scatter:
        id: scatter
        do_rotation: False
        do_translation: False
        do_scale: False
        size: root.size
        pos: root.pos
        center: root.center
        rotation: randint(0, 360)

        Image:
            source: root.source
            size: root.size
            center_x: self.center_x
            center_y: self.center_y
            allow_stretch: True
            keep_ratio: False

<Boat>
    scatter: scatter
    source: "img/boat.png"
    size: dp(30), dp(100)
    speed: -1.5
    rot_change: random()
    
    Scatter:
        id: scatter
        do_rotation: False
        do_translation: False
        do_scale: False
        size: root.size
        pos: root.pos
        center: root.center
        rotation: randint(0, 360)

        Image:
            source: root.source
            size: root.size
            center_x: self.center_x
            center_y: self.center_y
            allow_stretch: True
            keep_ratio: False

# frog description
<Frog>
    scatter: scatter
    sit_img: self.sit_img
    jump_img: self.jump_img
    source: self.sit_img
    size: dp(35), dp(75)
    place: self.place
    alive: True
    player: False
    Scatter:
        id: scatter
        do_rotation: False
        do_translation: False
        do_scale: False
        size: root.size
        pos: root.pos
        center: root.center

        Image:
            source: root.source
            size: root.size
            center_x: self.center_x
            center_y: self.center_y
            allow_stretch: True
            keep_ratio: False
            
# water lily description
<WaterLily>
    scatter: scatter
    source: "img/water_lily_001.png"
    size: dp(60), dp(60)
    free: True
    static: False
    Scatter:
        id: scatter
        do_rotation: False
        do_translation: False
        do_scale: False
        rotation: randint(0, 360)
        size: root.size
        pos: root.pos
        center: root.center

        Image:
            source: root.source
            size: root.size
            center_x: self.center_x
            center_y: self.center_y
            allow_stretch: True
            keep_ratio: False


<Base@Image>
    source: self.source
    size: dp(200), dp(60)
    allow_stretch: True
    keep_ratio: False
    free: True
    static: True

<StoneLily@WaterLily>
    static: True
    source: "img/water_lily_stone.png"
    

<MainWidget>
    app: app
    size: dp(700), dp(660)
    pos: 0, 0
    frog: frog
    background: background
    start: start
    end: end
    jumpline: jumpline
    status: status
    energy_label: energy_label
    lilys: (lily, lily_001, lily_002, lily_003, lily_004, lily_005)
    frogs: (frog, frog1)
    flys: (fly, fly1, fly2, fly3)
    player: frog
    live_imgs: [live, live1, live2]
    lives: 3
    energy: 4
    running: True
    Background:
        id: background
        source: "img/background_dark.png"

    Base:
        id: start
        x: dp(300)
        y: 0
        source: "img/start.png"
        free: False

    Base:
        id: end
        center_x: start.center_x
        y: start.y + dp(600)
        source: "img/end.png"
    
    WaterLily:
        app: app
        id: lily
        center_x: start.center_x
        y: start.y + dp(100)

    StoneLily:
        app: app
        id: lily_001
        center_x: start.center_x
        y: start.y + dp(200)
        free: False

    WaterLily:
        app: app
        id: lily_002
        center_x: start.center_x
        y: start.y + dp(330)

    WaterLily:
        app: app
        id: lily_003
        center_x: start.center_x
        y: start.y + dp(400)
    
    WaterLily:
        app: app
        id: lily_004
        center_x: start.center_x
        y: start.y + dp(520)

    WaterLily:
        app: app
        id: lily_005
        center_x: start.center_x + dp(100)
        y: start.y + dp(520)

    JumpLine:
        id: jumpline

    Fly:
        app: app
        id: fly
        center: root.center

    Fly:
        app: app
        id: fly1
        center: dp(200), dp(300)

    Fly:
        app: app
        id: fly2
        center: dp(450), dp(300)

    Fly:
        app: app
        id: fly3
        center: dp(200), dp(60)

    Boat:
        app: app
        id: boat
        center: dp(300), dp(400)

    Frog:
        app: app
        id: frog
        player: True
        angle: 0
        sit_img: "img/frog_green_sit.png"
        jump_img: "img/frog_green_jump.png"
        place: start
        center_x: self.place.center_x
        center_y: self.place.center_y

    Frog:
        app: app
        id: frog1
        angle: 0
        sit_img: "img/frog_green_sit.png"
        jump_img: "img/frog_green_jump.png"
        place: lily_001
        center_x: self.place.center_x
        center_y: self.place.center_y

    Live:
        id: live
        top: root.height - dp(5)
        x: dp(10)
    Live:
        id: live1
        top: root.height - dp(5)
        x: dp(50)
    Live:
        id: live2
        top: root.height - dp(5)
        x: dp(90)

    Label:
        id: energy_label
        top: root.height - dp(5)
        right: root.width
        text: "Energy: " + str(root.energy)

    Label:
        id: status
        center_x: root.center_x
        center_y: root.center_y
        font_size: dp(30)

